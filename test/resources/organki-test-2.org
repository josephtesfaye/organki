#+ANKI_DECK: Test
#+ANKI_NOTETYPE: Vocabulary
#+ANKI_TAGS: tag1 tag2

* Default value via in-buffer settings :tag3:tag4:
:PROPERTIES:
:ANKI_TAGS: tag5 tag6
:END:

This case tests the specification of the default values of Organki properties
through in-buffer settings.

#+ATTR_ANKI: :tags "tag7 tag8"
- lapilli [ləˈpɪlʌɪ] n. pl. (Geology) rock fragments ejected from a volcano 火山砾
- cumulonimbus [ˌkjuːmələʊˈnɪmbəs] n. a high mass of thick cloud with a flat
  base, often seen during thunderstorms 积雨云

#+ATTR_ARGS: :bindings :vfields1
#+begin_example
#separator:tab
#html:true
#notetype column:1
#deck column:2
#tags column:3
Vocabulary	Test	tag1::tag3::tag7 tag1::tag3::tag8 tag1::tag4::tag7 tag1::tag4::tag8 tag1::tag5::tag7 tag1::tag5::tag8 tag1::tag6::tag7 tag1::tag6::tag8 tag2::tag3::tag7 tag2::tag3::tag8 tag2::tag4::tag7 tag2::tag4::tag8 tag2::tag5::tag7 tag2::tag5::tag8 tag2::tag6::tag7 tag2::tag6::tag8	lapilli	[ləˈpɪlʌɪ]	n.	pl. (Geology) rock fragments ejected from a volcano 火山砾	
Vocabulary	Test	tag1::tag3::tag7 tag1::tag3::tag8 tag1::tag4::tag7 tag1::tag4::tag8 tag1::tag5::tag7 tag1::tag5::tag8 tag1::tag6::tag7 tag1::tag6::tag8 tag2::tag3::tag7 tag2::tag3::tag8 tag2::tag4::tag7 tag2::tag4::tag8 tag2::tag5::tag7 tag2::tag5::tag8 tag2::tag6::tag7 tag2::tag6::tag8	cumulonimbus	[ˌkjuːmələʊˈnɪmbəs]	n.	a high mass of thick cloud with a flat base, often seen during thunderstorms 积雨云	
#+end_example

* Mixed-language entries (English/Japanese)
Test the support for mixed-language entries (English/Japanese) in a Vocabulary list.

Here is a Vocabulary list whose entries contain both English and Japanese ones:

- 今日 n. today
- 今日 きょう n. today
- 今日 きょう [1] n. today
- 今日 きょう [1] [[cl:foo.wav][⏯]] n. today
- 昼間 ひる・ま [3] [[cl:foo.mp3][⏯]] / ちゅう・かん [0] [[cl:foo.mp3][⏯]] n. daytime 白天
- shell membrane n. 蛋壳膜
- shell membrane [abc] n. 蛋壳膜
- shell membrane [abc] [[cl:foo.wav][⏯]] n. 蛋壳膜
- shell membrane [[cl:foo.wav][⏯]] n. 蛋壳膜
- shell membrane [abc] [[cl:foo.wav][⏯]] n. 蛋壳膜
  蛋壳膜
  蛋壳膜
- 今日                                                     n.  today
- 今日            きょう                                   n.  today
- 今日            きょう   [1]                             n.  today
- 今日            きょう   [1]   [[cl:foo.wav][⏯]]                        n.  today
- 昼間            ひる・ま [3]   [[cl:foo.mp3][⏯]] / ちゅう・かん [0] [[cl:foo.mp3][⏯]]  n.  daytime 白天
- shell membrane                                           n.  蛋壳膜
- shell membrane  [abc]                                    n.  蛋壳膜
- shell membrane  [abc]          [[cl:foo.wav][⏯]]                        n.  蛋壳膜
- shell membrane                 [[cl:foo.wav][⏯]]                        n.  蛋壳膜

#+ATTR_ARGS: :bindings :vfields1
#+begin_example
#separator:tab
#html:true
#notetype column:1
#deck column:2
#tags column:3
Vocabulary	Test	tag1 tag2	今日		n.	today	
Vocabulary	Test	tag1 tag2	今日	きょう	n.	today	
Vocabulary	Test	tag1 tag2	今日	きょう [1]	n.	today	
Vocabulary	Test	tag1 tag2	今日	きょう [1] [sound:foo.wav]	n.	today	
Vocabulary	Test	tag1 tag2	昼間	ひる・ま [3] [sound:foo.mp3] / ちゅう・かん [0] [sound:foo.mp3]	n.	daytime 白天	
Vocabulary	Test	tag1 tag2	shell membrane		n.	蛋壳膜	
Vocabulary	Test	tag1 tag2	shell membrane	[abc]	n.	蛋壳膜	
Vocabulary	Test	tag1 tag2	shell membrane	[abc] [sound:foo.wav]	n.	蛋壳膜	
Vocabulary	Test	tag1 tag2	shell membrane	[sound:foo.wav]	n.	蛋壳膜	
Vocabulary	Test	tag1 tag2	shell membrane	[abc] [sound:foo.wav]	n.	蛋壳膜 蛋壳膜 蛋壳膜	
Vocabulary	Test	tag1 tag2	今日		n.	today	
Vocabulary	Test	tag1 tag2	今日	きょう	n.	today	
Vocabulary	Test	tag1 tag2	今日	きょう [1]	n.	today	
Vocabulary	Test	tag1 tag2	今日	きょう [1]   [sound:foo.wav]	n.	today	
Vocabulary	Test	tag1 tag2	昼間	ひる・ま [3]   [sound:foo.mp3] / ちゅう・かん [0] [sound:foo.mp3]	n.	daytime 白天	
Vocabulary	Test	tag1 tag2	shell membrane		n.	蛋壳膜	
Vocabulary	Test	tag1 tag2	shell membrane	[abc]	n.	蛋壳膜	
Vocabulary	Test	tag1 tag2	shell membrane	[abc] [sound:foo.wav]	n.	蛋壳膜	
Vocabulary	Test	tag1 tag2	shell membrane	[sound:foo.wav]	n.	蛋壳膜	
#+end_example

* Test organki/convert-vocabulary-body-function
Test the usage of the variable ~organki/convert-vocabulary-body-function~.

- 今日 きょう [1] [[cl:foo.wav][⏯]] n. today
- shell membrane [abc] [[cl:foo.wav][⏯]] n. 蛋壳膜

#+ATTR_ARGS: :bindings :vfields1
#+begin_example
#separator:tab
#html:true
#notetype column:1
#deck column:2
#tags column:3
Vocabulary	Test	tag1 tag2	今日	きょう [1] [sound:foo.wav]	n.	today	
Vocabulary	Test	tag1 tag2	shell membrane	[abc] [sound:foo.wav]	n.	蛋壳膜	
#+end_example

You can change how the vocabulary body is converted (the old way) by supplying a
function to the variable ~organki/convert-vocabulary-body-function~. For example,
when it's supplied with ~organki--convert-vocabulary-body-old~ the output is:

#+NAME: TOKYO20250924093055
#+ATTR_ARGS: :points (4077) :test noauto
#+begin_example
#separator:tab
#html:true
#notetype column:1
#deck column:2
#tags column:3
Vocabulary	Test	tag1 tag2	今日	きょう [1] [sound:foo.wav] n.	today	
Vocabulary	Test	tag1 tag2	shell membrane	[abc] [sound:foo.wav] n.	蛋壳膜	
#+end_example

and when it's nil (default) the output is:

#+NAME: TOKYO20250926230233
#+ATTR_ARGS: :points (4077) :test noauto
#+begin_example
#separator:tab
#html:true
#notetype column:1
#deck column:2
#tags column:3
Vocabulary	Test	tag1 tag2	今日	きょう [1] [sound:foo.wav]	n.	today		
Vocabulary	Test	tag1 tag2	shell membrane	[abc] [sound:foo.wav]	n.	蛋壳膜		
#+end_example

* Test ~organki-test--get-tests~ :noauto:
Test ~organki-test--get-tests~ in normal usage:

#+begin_src org
,* Heading

,#+begin_src org
A
,#+end_src

The following output has 4 inputs:

,#+ATTR_ARGS: :test noauto
- The input above it (12)
- The input named "20251002220322" in the current file (873)
- The input in the file "organki-test.org" in the current directory and named
  "20251002220511" (5351)
- The input in the file "readme.org" in the project root and named
  "organki-example-properties" (15886)

,#+ATTR_ARGS: :inputs ("20251002220322"
,#+ATTR_ARGS:          "organki-test.org::202410212013"
,#+ATTR_ARGS:          "r:readme.org::organki-example-properties")
,#+begin_example
B
,#+end_example

,#+begin_src org
C
,#+end_src

,#+ATTR_ARGS: :inputs ("20251002220322"
,#+ATTR_ARGS:          "organki-test.org::202410212013")
,#+ATTR_ARGS: :composite D
,#+begin_example
D
,#+end_example

,#+ATTR_ARGS: :composite E
,#+begin_example
E
,#+end_example

,#+begin_example
F
,#+end_example

,#+NAME: 20251002220322
,#+ATTR_ARGS: :test noauto
,#+begin_src org
G
,#+end_src
#+end_src

The output of calling ~(organki-test--get-tests 1)~ should be:

#+begin_example
((12                                                                ; input A
  (401                                                              ; output B
   (869                                                             ; input G
    ("organki-test.org" . 403)                                      ; input
    ("/Users/josephtesfaye/projects/organki/readme.org" . 16326)))) ; input
 (594                                                               ; input C
  ((623 777)                                                        ; output D+E
   (869                                                             ; input G
    ("organki-test.org" . 403)))                                    ; input
  836))                                                             ; output F
#+end_example

Test consecutive composite outputs:

#+begin_src org
,* Heading
,#+begin_src org
A
,#+end_src

,#+NAME: 20251013145359
,#+ATTR_ARGS: :test noauto
,#+begin_src org
B
,#+end_src

The following output has 1 extra input:

,#+ATTR_ARGS: :test noauto
- The input named "20251013145359" in the current file (63)

,#+ATTR_ARGS: :inputs ("20251013145359" "20251013145359")
,#+ATTR_ARGS: :composite C
,#+begin_example
C
,#+end_example

,#+ATTR_ARGS: :composite D
,#+begin_example
D
,#+end_example

Another input:

,#+begin_src org
E
,#+end_src

,#+ATTR_ARGS: :composite F
,#+begin_example
F
,#+end_example

,#+ATTR_ARGS: :composite G
,#+begin_example
G
,#+end_example
#+end_src

The output of calling ~(organki-test--get-tests 1)~ should be:

#+begin_example
((11 ((246 362) (40 40))) (437 (466 525)))
#+end_example

#+begin_src org
,* Heading
,#+begin_src org
A
,#+end_src

,#+NAME: 20251013145359
,#+ATTR_ARGS: :test noauto
,#+begin_src org
B
,#+end_src

The following output has 1 extra input:

,#+ATTR_ARGS: :test noauto
- The input named "20251013145359" in the current file (63)

,#+ATTR_ARGS: :inputs ("20251013145359" "20251013145359")
,#+ATTR_ARGS: :composite C
,#+begin_example
C
,#+end_example

,#+ATTR_ARGS: :composite D
,#+begin_example
D
,#+end_example
#+end_src

The output of calling ~(organki-test--get-tests 1)~ should be:

#+begin_example
((11 ((246 362) (40 40))))
#+end_example

* Test ~org-list-get-attr-args~

#+begin_src org
,#+ANKI_DECK: Test
,#+ANKI_NOTETYPE: Vocabulary

1. number + 番目（ばんめ）

   ,#+ATTR_ANKI: :notetype "Sentence"
   - 一番目のドアを開けてください。 Please open the first door.
     - V:
       - 一番目 いちばんめ phrn. first

   - 二番目の問題に答えてください。 Please answer the second question.

2. つ + 目（め）
#+end_src

#+ATTR_ARGS: :regions ((69 253) (106 252))
#+ATTR_ARGS: :composite Sentence
#+begin_example
#separator:tab
#html:true
#notetype column:1
#deck column:2
Sentence	Test	一番目のドアを開けてください。		Please open the first door.	<b>Vocabulary</b><ul><li>一番目 いちばんめ phrn. first</li></ul>
Sentence	Test	二番目の問題に答えてください。		Please answer the second question.	
#+end_example

#+ATTR_ARGS: :composite Vocabulary
#+begin_example
#separator:tab
#html:true
#notetype column:1
#deck column:2
Vocabulary	Test	一番目	いちばんめ	phrn.	first		<b>Examples</b><ul><li>一番目のドアを開けてください。 Please open the first door.</li></ul>
#+end_example

* Test diacritics
Test [[p:notes/eecs.org::#20251009164033][decomposed kana characters]].

#+begin_src org
,#+ANKI_DECK: Test
,#+ANKI_NOTETYPE: Vocabulary

- 三匹目の犬 さんびきめのいぬ phrn. the third dog
- 一頭目の象 いっとうめのぞう phrn. the first elephant
#+end_src

#+ATTR_ARGS: :points (48)
#+begin_example
#separator:tab
#html:true
#notetype column:1
#deck column:2
Vocabulary	Test	三匹目の犬	さんびきめのいぬ	phrn.	the third dog		
Vocabulary	Test	一頭目の象	いっとうめのぞう	phrn.	the first elephant		
#+end_example

* Convert plain lists to HTML
- accrete [ə'kri:t] vi./vt. grow or form by accumulation or coalescence 积淀、增生
  - E:
    - It's not even all that easy to navigate, because most of the material has
      just accreted over the past seven years.
    - The collection of art he had accreted was to be sold.

#+begin_example
#separator:tab
#html:true
#notetype column:1
#deck column:2
#tags column:3
Vocabulary	Test	tag1 tag2	accrete	[ə'kri:t]	vi./vt.	grow or form by accumulation or coalescence 积淀、增生		<b>Examples</b><p><ul><li>It&apos;s not even all that easy to navigate, because most of the material has just accreted over the past seven years.</li><li>The collection of art he had accreted was to be sold.</li></ul></p>
#+end_example

* Convert leveled strings to HTML lists
- rivet [ˈrɪvɪt] n./v. <<rivet>> a short metal pin or bolt for holding together
  two metal plates, its headless end being beaten out or pressed down when in
  place 铆钉 / join or fasten with a rivet or rivets; 铆、铆接

- adjunct [ˈædʒʌŋkt] n./adj. 1. a thing added to something else as a
  supplementary rather than an essential part; 1.1. a person who is another's
  assistant or subordinate; 2. [Grammar] a word or phrase that constitutes an
  optional element / 1. connected or added to something; 1.1. [NAmE] (of an
  academic post) attached to the staff of a university in a temporary or
  assistant capacity

#+begin_example
#separator:tab
#html:true
#notetype column:1
#deck column:2
#tags column:3
Vocabulary	Test	tag1 tag2	rivet	[ˈrɪvɪt]	n./v.	<div>n.</div>a short metal pin or bolt for holding together two metal plates, its headless end being beaten out or pressed down when in place 铆钉 <div>v.</div> join or fasten with a rivet or rivets; 铆、铆接		
Vocabulary	Test	tag1 tag2	adjunct	[ˈædʒʌŋkt]	n./adj.	<div>n.</div><ol><li>a thing added to something else as a supplementary rather than an essential part<ol><li>a person who is another&apos;s assistant or subordinate</li></ol></li><li>[Grammar] a word or phrase that constitutes an optional element</li></ol><div>adj.</div><ol><li>connected or added to something<ol><li>[NAmE] (of an academic post) attached to the staff of a university in a temporary or assistant capacity</li></ol></li></ol>		
#+end_example

* Optimize delimiters for Sentence lists
:PROPERTIES:
:ANKI_NOTETYPE: Sentence
:END:

Test supported delimiters between entry and translation (=。?？/=), and between
speaker and entry (=:：=).

- タンさん、お仕事は？ Mr. Tan, what do you do for work?
- Sarah: タンさん、お仕事は？ Mr. Tan, what do you do for work?
- サラ：タンさん、お仕事は？ Mr. Tan, what do you do for work?
- [[cl:202403132337.m4a][⏯]] サラ：タンさん、お仕事は？ Mr. Tan, what do you do for work?
- Mr. Tan, what do you do for work? / タンさん、お仕事は？
- Sarah: Mr. Tan, what do you do for work. / タンさん、お仕事は？
- タンさん、お仕事は？
  - T: Mr. Tan, what do you do for work?

#+begin_example
#separator:tab
#html:true
#notetype column:1
#deck column:2
#tags column:3
Sentence	Test	tag1 tag2	タンさん、お仕事は？		Mr. Tan, what do you do for work?	
Sentence	Test	tag1 tag2	Sarah: タンさん、お仕事は？		Sarah: Mr. Tan, what do you do for work?	
Sentence	Test	tag1 tag2	サラ： タンさん、お仕事は？		サラ： Mr. Tan, what do you do for work?	
Sentence	Test	tag1 tag2	[sound:202403132337.m4a] サラ： タンさん、お仕事は？		サラ： Mr. Tan, what do you do for work?	
Sentence	Test	tag1 tag2	Mr. Tan, what do you do for work?		タンさん、お仕事は？	
Sentence	Test	tag1 tag2	Sarah: Mr. Tan, what do you do for work.		Sarah: タンさん、お仕事は？	
Sentence	Test	tag1 tag2	タンさん、お仕事は？		Mr. Tan, what do you do for work?	
#+end_example

- Part 2
  - M:
    - タンさん、お仕事は？ Mr. Tan, what do you do for work?
    - Sarah: タンさん、お仕事は？ Mr. Tan, what do you do for work?
    - サラ：タンさん、お仕事は？ Mr. Tan, what do you do for work?
    - [[cl:202403132337.m4a][⏯]] サラ：タンさん、お仕事は？ Mr. Tan, what do you do for work?
    - Mr. Tan, what do you do for work? / タンさん、お仕事は？
    - Sarah: Mr. Tan, what do you do for work. / タンさん、お仕事は？

#+begin_example
#separator:tab
#html:true
#notetype column:1
#deck column:2
#tags column:3
Sentence	Test	tag1 tag2	タンさん、お仕事は？<br>Sarah: タンさん、お仕事は？<br>サラ： タンさん、お仕事は？<br>[sound:202403132337.m4a] サラ： タンさん、お仕事は？<br>Mr. Tan, what do you do for work?<br>Sarah: Mr. Tan, what do you do for work.		Mr. Tan, what do you do for work?<br>Sarah: Mr. Tan, what do you do for work?<br>サラ： Mr. Tan, what do you do for work?<br>サラ： Mr. Tan, what do you do for work?<br>タンさん、お仕事は？<br>Sarah: タンさん、お仕事は？	
#+end_example
